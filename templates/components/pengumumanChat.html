<section class="h-[500px] overflow-y-auto rounded-lg p-4 bg-white dark:bg-gray-800">
    <div class="flex flex-col space-y-4" id="chatContainer">
        {% for pengumuman in pengumuman_list %}
        {% if kategori == 'produk' and pengumuman.kategori == 'Produk' %}
        <div class="flex items-start gap-2.5">
            <img class="w-8 h-8 rounded-full" src="https://img.icons8.com/?size=100&id=492ILERveW8G&format=png&color=000000" alt="Avatar pengumuman">
            <div class="flex flex-col w-full max-w-[320px] leading-1.5 p-4 bg-gray-100 rounded-e-xl rounded-es-xl dark:bg-gray-600">
                <div class="flex items-center space-x-2 rtl:space-x-reverse">
                    <span class="text-sm font-semibold text-gray-900 dark:text-white">{{ pengumuman.user.username }}</span>
                    <span class="text-sm font-normal text-gray-500 dark:text-gray-400">{{ pengumuman.waktu }}</span>
                </div>
                <p class="text-sm font-normal py-2.5 text-gray-900 dark:text-white">{{ pengumuman.pesan }}</p>
                <span class="text-sm font-normal text-gray-500 dark:text-gray-400">Kategori: {{ pengumuman.kategori }}</span>
            </div>
        </div>
        {% elif kategori == 'teknisi' and pengumuman.kategori == 'Teknisi' %}
        <div class="flex items-start gap-2.5">
            <img class="w-8 h-8 rounded-full" src="https://img.icons8.com/?size=100&id=492ILERveW8G&format=png&color=000000" alt="Avatar pengumuman">
            <div class="flex flex-col w-full max-w-[320px] leading-1.5 p-4 bg-gray-100 rounded-e-xl rounded-es-xl dark:bg-gray-600">
                <div class="flex items-center space-x-2 rtl:space-x-reverse">
                    <span class="text-sm font-semibold text-gray-900 dark:text-white">{{ pengumuman.user.username }}</span>
                    <span class="text-sm font-normal text-gray-500 dark:text-gray-400">{{ pengumuman.waktu }}</span>
                </div>
                <p class="text-sm font-normal py-2.5 text-gray-900 dark:text-white">{{ pengumuman.pesan }}</p>
                <span class="text-sm font-normal text-gray-500 dark:text-gray-400">Kategori: {{ pengumuman.kategori }}</span>
            </div>
        </div>
        {% elif kategori == 'sales' and pengumuman.kategori == 'Sales' %}
        <div class="flex items-start gap-2.5">
            <img class="w-8 h-8 rounded-full" src="https://img.icons8.com/?size=100&id=492ILERveW8G&format=png&color=000000" alt="Avatar pengumuman">
            <div class="flex flex-col w-full max-w-[320px] leading-1.5 p-4 bg-gray-100 rounded-e-xl rounded-es-xl dark:bg-gray-600">
                <div class="flex items-center space-x-2 rtl:space-x-reverse">
                    <span class="text-sm font-semibold text-gray-900 dark:text-white">{{ pengumuman.user.username }}</span>
                    <span class="text-sm font-normal text-gray-500 dark:text-gray-400">{{ pengumuman.waktu }}</span>
                </div>
                <p class="text-sm font-normal py-2.5 text-gray-900 dark:text-white">{{ pengumuman.pesan }}</p>
                <span class="text-sm font-normal text-gray-500 dark:text-gray-400">Kategori: {{ pengumuman.kategori }}</span>
            </div>
        </div>
        {% endif %}
        {% endfor %}
    </div>
</section>

<script>
    // Dummy data untuk pengumuman
    const pengumuman_list = [
        {
            waktu: "09:30",
            pesan: "Selamat pagi! Hari ini ada pembaruan sistem pada pukul 14:00. Mohon siapkan data Anda sebelum waktu tersebut.",
            kategori: "Produk",
            user: { username: "AdminSistem" }
        },
        {
            waktu: "11:15",
            pesan: "Pengumuman: Rapat tim akan diadakan besok pukul 10:00 di ruang konferensi utama.",
            kategori: "Teknisi",
            user: { username: "ManagerTim" }
        },
        {
            waktu: "13:45",
            pesan: "Perhatian kepada seluruh sales: Target penjualan bulan ini telah diperbarui. Silakan cek dashboard Anda untuk informasi lebih lanjut.",
            kategori: "Sales",
            user: { username: "KepalaSales" }
        },
        {
            waktu: "16:20",
            pesan: "Maintenance server akan dilakukan malam ini pukul 23:00. Mohon simpan pekerjaan Anda sebelum waktu tersebut.",
            kategori: "Produk",
            user: { username: "AdminIT" }
        }
    ];

    // Fungsi untuk merender pengumuman
    function renderPengumuman() {
        const container = document.getElementById('chatContainer');
        container.innerHTML = ''; // Bersihkan container

        const kategori = '{{ kategori }}'; // Ambil kategori dari konteks Django

        pengumuman_list.forEach(pengumuman => {
            if ((kategori === 'produk' && pengumuman.kategori === 'Produk') ||
                (kategori === 'teknisi' && pengumuman.kategori === 'Teknisi') ||
                (kategori === 'sales' && pengumuman.kategori === 'Sales')) {
                const pengumumanElement = document.createElement('div');
                pengumumanElement.className = 'flex items-start gap-2.5';
                pengumumanElement.innerHTML = `
                    <img class="w-8 h-8 rounded-full" src="https://img.icons8.com/?size=100&id=492ILERveW8G&format=png&color=000000" alt="Avatar pengumuman">
                    <div class="flex flex-col w-full max-w-[320px] leading-1.5 p-4 bg-gray-100 rounded-e-xl rounded-es-xl dark:bg-gray-600">
                        <div class="flex items-center space-x-2 rtl:space-x-reverse">
                            <span class="text-sm font-semibold text-gray-900 dark:text-white">${pengumuman.user.username}</span>
                            <span class="text-sm font-normal text-gray-500 dark:text-gray-400">${pengumuman.waktu}</span>
                        </div>
                        <p class="text-sm font-normal py-2.5 text-gray-900 dark:text-white">${pengumuman.pesan}</p>
                        <span class="text-sm font-normal text-gray-500 dark:text-gray-400">Kategori: ${pengumuman.kategori}</span>
                    </div>
                `;
                container.appendChild(pengumumanElement);
            }
        });
    }

    // Panggil fungsi render saat halaman dimuat
    document.addEventListener('DOMContentLoaded', renderPengumuman);
</script>
